// prisma/schema.prisma
// Define your database models

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            Int      @id @default(autoincrement())
  email         String   @unique
  name          String
  phone         String?
  password_hash String
  role          String   @default("user")
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  brokerAccounts brokerAccount[]
}

model brokerAccount {
  id     Int @id @default(autoincrement())
  userId Int

  broker       String //Zerodha, Upstox, AngelOne
  brokerUserId String? //return by broker

  accessToken   String
  refreshToken  String?
  tokenExpireAt DateTime?

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])

  @@unique([userId, broker])
}
